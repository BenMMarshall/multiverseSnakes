---
title: "Snake Habitat Selection Findings are not Undermined by Researcher Analysis Choice"
author1: "Benjamin Michael Marshall*"
author2: "Matthew Crane"
author3: "Cameron Wesley Hodges"
author4: "Max Dolton Jones"
author5: "Tyler Keith Knierim"
author6: "Samantha Nicole Smith"
author7: "Inês Silva"
author8: "Colin Thomas Strine"
author9: "Alexander Bradley Duthie**"
affiliation1: "Biological and Environmental Sciences, Faculty of Natural Sciences, University of Stirling, Stirling, FK9 4LA, Scotland, UK"
affiliation2: "---"
affiliation3: "Western Ecosystems Technology, Inc, 415 W. 17th Street, Suite 200, Cheyenne, WY 82001, USA"
affiliation4: "Department of Fish and Wildlife Conservation, Virginia Tech, 310 W. Campus Drive, Blacksburg, VA, 24061, USA"
affiliation5: "Department of Forestry and Environmental Conservation, 261 Lehotsky Hall, Clemson University, Clemson, SC 29634, USA"
affiliation6: "Center for Advanced Systems Understanding (CASUS), Helmholtz-Zentrum Dresden-Rossendorf (HZDR), Görlitz, Germany"
affiliation7: "Department of Natural Sciences, Dickinson State University; Dickinson, North Dakota, 58601, United States"
corresponding1: "benjaminmichaelmarshall@gmail.com"
corresponding2: "alexander.duthie@stir.ac.uk"
date: "`r Sys.Date()`"
output:
  bookdown::pdf_document2:
    template: main.tex
    keep_tex: true
    highlight: monochrome
    fig_caption: true
    dev: pdf
    extra_dependencies: ["float"]
  bookdown::html_document2:
    theme: yeti
    highlight: monochrome
    fig_caption: true
link-citations: yes
linkcolor: gray
bibliography: [multiverseSnakes_refs.bib, packages_refs.bib]
csl: peerj.csl
editor_options: 
  markdown: 
    wrap: sentence
abstract: Possibly the best way to determine a snake’s needs is to follow their movements. Once we have learnt of the snake’s movements we can infer habitat requirements, behaviour, and potential threats. Combined, the movement data and inferences can inform decisions on snake conservation and human-snake conflict. Extracting useful information from snake movement requires many steps, from sampling to analysis. Other studies have shown that a single dataset can result in many different answers in the hands of different researchers, so how can we be confident the results from snake movement studies are providing the correct guidance for snake conservation? We used a multiverse approach to explore several thousand ways of extracting habitat selection estimates from four snake movement datasets, using categorical and continuous classifications of the landscape. The resulting habitat selection estimates showed an overall agreement with regards to direction, indicating general support for the original conclusions on the snakes' selected habitats. However, the strength of the selection appeared more sensitive to choices made during analysis, with several analysis choices appearing only to be impactful with a particular species' data. This leads us to suggest that generalisations on the impact of specific analysis decisions may be difficult to predict a priori for other species and study systems. The broad agreement shown here should bolster confidence in past studies' conclusions. Whereas the variation displayed in the selection strengths highlights how analysis choices could inflate the differences between studies.
keywords: Movement ecology, simulation, step selection function, poisson, habitat preference, habitat selection, animal movement, multiverse, researcher choice, researcher degrees for freedom, snakes, King Cobra, Burmese Python, Banded Krait, Malayan Krait
---

# Introduction

<!-- reproducibility crisis -->
<!-- Baker 2016 -->

A key component of science is the continual reassessment of past work and findings [@alberts_self-correction_2015], whether that reassessment takes the form of direct replications aiming to evaluate the reliability of previous work, or a more integrative approach testing the boundaries of previous findings' generalisability by retesting questions in different study systems (e.g., quasi-replications) [@nakagawa_replicating_2015; @peterson_self-correction_2021]. <!-- see peterson paper for definition check . Also add quasi-rep citation --> 

<!-- Direct quote from Peterson 2021 - "When replication in the normal course of integration does not provide clear signals of truth or falsity, researchers instead look for signs of robustness." -->

Reassessments and replications can aid the formal and organic self-correcting process of science.
Initial findings set the stage for subsequent work, building momentum that can accelerate progress, but this momentum can be difficult to redirect after the initial impetus [@jennions_relationships_2002; @barto_dissemination_2012] <!-- thinking the progress papers, think it was by barto about early research that is underpowered starting trends that are hard to stop -->.
In ecology and evolution, research on mating systems shows exactly this momentum.
Early studies on *Anolis spp.* mating systems concluded that territoriality played a key role in mating success by controlling access to breeding females [@Kamath2017; @Kamath2018a].
The assumption of a polygynous mating system coloured and shaped subsequent research, and was only adequately challenged when genetic investigation revealed the importance of female mate choice and multiple partners [@Kamath2018.
The new research highlighted that the initial assumptions of territoriality were overly strong and had misdirected research and obscured an important part of *Anolis* ecology [@Kamath2017; @Kamath2018a].
Similar perspective changes are seen in studies of bird mating systems, where earlier research focused on mating competition and potentially lost sight of explanations connected to mating cooperation [@griffith_cooperation_2019].
In this case, over emphasis on mate choice via differential ornamentation could obscure the roles of social compatibility (i.e., pair behavioural compatibility @ihle_fitness_2015; and the imperfect information communicated by ornamentation @wang_no_2017; @wang_male_2017). 
These examples emphasise the importance of checking and confirming results early, before assumptions are entrenched and can steer the focus of future studies; we can see this principle recognised in the peer review system.

Checking previous findings through replication is more difficult in systems with high task uncertainty. 
High task uncertainty systems leading to high levels of uncontrollable stochasticity, make direct diagnostic replications impractical or impossible, while rendering the evidence from quasi-replications weaker <!-- peterson pano 2021 is the paper for this stuff -->[@peterson_self-correction_2021].
Ecological systems generate high task uncertainty, with many interconnected elements, and when studying wild systems many of those elements are uncontrollable.
<!-- peterson pano 2021 has a bit about "task uncertainty" where high perfectly describes ecology and the hard to control system -->

With ecological systems, such complexity and the difficulties in controlling experiments makes direct replications costly, potentially explaining their rarity [@kelly_rate_2019].
When studying wild animals with a level of direct intervention, repeating experiments might be unethical due to the well-being costs [@Weatherhead2004; @tomotani_great_2021; @robstad_impact_2021; @portugal_externally_2022; @altobelli_methods_2022]. 
<!-- could add a couple more examples here -->
When faced with limited options for direct replications, an alternative approach would be to re-examine existing datasets.
Pooling old and new datasets and re-analysing them may provide opportunities for broader generalisations.
Good examples exist in movement ecology, where the re-examination of many animal movement datasets revealed general patterns of reduced mammal movement with increased human footprint [@Tucker2018], and increased bird movements in increasingly homogeneous landscapes [@tucker_large_2019].
These findings, based on many species, across various regions, are better placed to be the building blocks of future hypotheses.

In some cases older data may have been collected and recorded in ways that enables completely fresh analysis [@kays_movebank_2022].
As methodologies develop, conceptualisations of how systems operate change, and computational power increases, new avenues for examining the same data may materialise [e.g., @noonan_effects_2020].
As these new methods are developed and applied, we may see the conclusions based upon those data change.
There are a growing number of examples demonstrating that analysis approach can alter results [@salis_how_2021; @desbureaux_subjective_2021], and that researchers themselves can be a key source of variation in analysis and results [@silberzahn_many_2018; @huntingtonklein_influence_2021; @gould_same_2023].
Recently for ecology and evolution, @gould_same_2023 showed that when ~250 researchers were asked to answer the same question with the same dataset (either bird nestling success, or eucalyptus growth) the analysis approaches and results varied, and in some cases indicated opposing effects.
These examples elegantly show the possible extent of technical uncertainty present in some systems (i.e., the uncertainty resulting from differences in methodology)<!-- peterson and pano term again, needs defining -->.
In practice researchers often do not have the time to explore many possible analysis pathways; therefore, we may be underestimating the uncertainty surrounding published results.  

Not all disciplines have explored the sources of uncertainty in results equally.
Prudence would push for examination of uncertainty in all its forms, in particular for fields that already tackle high levels of uncertainty originating from wild study systems.
Movement ecology is such a field.
Animals are complex, existing in complex ecosystems with individuality and personality [@stuber_spatial_2022].
Depending on the research question, controls in movement ecology can be difficult to achieve, and replications difficult to justify given the strict ethical limitations on interventionist study.
Movement ecology has also seized the opportunities presented by technological developments, enabling higher resolution tracking of animal movements (e.g., GPS tracking) and more sophisticated analysis that can integrate the high dimensional data [e.g., x-y coordinates, time, acceleration, individual, other covariates of interest, @joo_recent_2022].

Personality and the repeatability of behaviours presents a key component of the variation when attempting to generalise in movement ecology [@stuber_spatial_2022]. 
However, here we focus on the technical uncertainty, the uncertainty originating from the researcher and how they approach the data.
Many analyst projects highlight the potential for analyst-side variation [@silberzahn_many_2018; @huntingtonklein_influence_2021; @gould_same_2023], and multiverse explorations of movement ecology methods highlight the variation potentially presented within a synthetic movement dataset [@marshall_habitat_2024] (also see Chapter 3).
Here we take the multiverse approach further by applying it to a number of real case studies to explore whether different analysis approaches alter general conclusions.

<!-- ecology has high "task uncertainty" stemming from high "technical" and "strategic task uncertainty" - Peterson pano 2021 -->

<!-- Peterson pano 2021 has a great line that when task uncertainty is higher and more uncontrollable variables exists then integrative replications are more open to interpretation. -->

We selected a quartet of separate but connected movement ecology studies that attempt to determine the habitat selection exhibited by snakes in north-eastern Thailand.
All four cases focus on snakes that come into conflict with humans to varying degrees, either because of the risks posed by their venom: King Cobra [@Marshall2018; @marshall_no_2020], Malayan Krait [@hodges_malayan_2022], Banded Krait [@knierim_spatial_2019], or because of their appetite for domestic livestock: Burmese python [@smith_native_2021].
In all cases, the habitat selection results could be used to guide snake conservation efforts, as well as interventions into human behaviour to mitigate human-snake conflict by highlighting what the snakes are drawn to.
With these general goals in mind, we aim to re-examine the movement datasets using a multiverse of habitat selection analysis pathways to reveal whether the same data could lead to different conclusions.

<!-- devezer et al 2021 - reproducing the results doesn't mean that they are more likely correct - pg 10. So instead here we are exploring the likely that conclusions would change, an attempt to gauge uncertainty with a number of ~equally~ valid analysis methods -->

<!-- Direct quote from Peterson 2021 - "When replication in the normal course of integration does not provide clear signals of truth or falsity, researchers instead look for signs of robustness." -->

# Methods

## Summary of Field Methods
<!-- NE Thailand -->
All four case studies occurred in north-eastern Thailand, within Nakhon Ratchasima province.
<!-- SERS -->
Three case studies (King Cobra, Burmese Python, Banded Krait) were conducted within the Sakaerat Biosphere Reserve.
The reserve consists of three zones of management: core, buffer, and transitional.
The core is largely primary forest; the buffer surrounds the core and is comprised of forest regeneration efforts, whereas the transitional zone allows more development resulting in a mix of agriculture, settlements, and plantation forest.
Bisecting the transitional zone, and running adjacent to the protected forest areas, is a four-lane highway connecting the city of Nakhon Ratchasima to Bangkok.
<!-- SUT University campus -->
The Malayan Krait case study was not in the Sakaerat Biosphere Reserve, instead undertaken nearer to Nakhon Ratchasima proper, on the Suranaree University of Technology campus.
The university campus is a mix of scrub forest, open lawn, university buildings, and homes.
Further details on the study sites' characteristics can be found in the original publications [@Marshall2018; @marshall_no_2020; @smith_native_2021; @hodges_malayan_2022; @knierim_spatial_2019].
For land use classification, we relied on data supplied by the Land Development Department of Thailand [@land_development_department_thailand_land-use_2017].

```{r locationFigure, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="The study site locations for all four case studies. Top left shows the location within Thailand, both the Sakaerat Biosphere Reserve and the Suranaree University of Technology campus are located within Nakhon Ratchasima Province. Bottom left shows the overall study location for King Cobra, Burmese Python, and Banded Krait (circular points). The purple areas depict the land uses that are included in any of the species hypotheses. Gray lines indicate roads. Bottom right is the same region, but focused on the Banded Krait locations to better show the field margin data used for their assessment of habitat selection. Top right is the study location for the Malayan Krait on the Suranaree University of Technology campus."}
knitr::include_graphics(here::here("notebook", "ext_images", "LocationMap.png"))
```

<!-- enough detail? and double check the match the original papers -->

Snakes can be difficult to detect in wild scenarios [@Durso2015; @boback_use_2020], requiring a wider and more opportunistic suite of methods to gather adequate sample sizes.
In all the chosen case studies snakes were obtained for study using trapping arrays, active surveying, and notifications from locals.
The local notifications often arose from snakes entering human settlements, and a desire for the snake to be removed.
<!-- maybe summary table here of capture methods -->

In all cases, we implanted snakes with Holohil radio transmitters (either AI-2T, SI-2T, SB-2, or BD-2, Holohil Inc., Ontario, Canada)).
<!-- grab citation from older papers -->
The implant procedure was conducted by trained team members, or later by independent trained veterinarians, following @Reinert1982.
We anaesthetised snakes with isoflurane and implanted transmitters in the coelomic cavity.
The size of the transmitter varied between species and was calibrated to body size.
At no time did we implant transmitters exceeding 5% of the body mass of the animal; in the vast majority of cases, the transmitter weighed considerably less than 1% (e.g., King Cobra 0.55 ±SD 0.47%; Banded Krait 0.01 ±SD 0.09%; Burmese Python 0.26%).
Inspections of longer-term tracked individuals indicated that transmitter presence was not detrimental to their health [@marshall_no_2020].
Greater details on the implantation procedure, and supplemental snake processing, can be found in the original publications.

Once implanted, we released snakes back into the wild as near as feasibly possible to their capture location; human-snake conflict was the main reason that exact return to capture location was not achieved.
Following release, we routinely relocated the snakes using radio receivers, triangulating their locations then recording coordinates with handheld GPS devices.
The four species had varying tracking regimes, which did not necessarily remain consistent across the entire study period.
However, broadly speaking the tracking regime for King Cobras was three to four locations a day, whereas the other species we located once per day.
The main exception is for the first three tracked King Cobra, who we tracked more intensely.

## Study Species and Hypotheses

We simplified the conclusions of the original studies into hypotheses targeting the preferred habitat for each species.
We registered these hypotheses prior to undertaking the multiverse exploration ([https://osf.io/kv8rg/](https://osf.io/kv8rg/)), they remained unchanged and are detailed below.

```{r hypothesesFigure, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="A summary of the species and hypotheses derived from the original studies regarding the habitat selection of each snake species. Alongside are the sample sizes for each species and a visualisation describing the two landscape classifications used in the multiverse."}
knitr::include_graphics(here::here("notebook", "ext_images", "hypothesis_visual.png"))
```

### King Cobra

@Marshall2018; @marshall_no_2020 are concerned with King Cobras (*Ophiophagus hannah*).
King Cobras are a large (tracked individuals between 1.40 and 3.71m snout to vent length), diurnal, active foraging snake species that depredate snakes and monitor lizards [@Jones_supposed_2020].
While considered a predominately forest-dwelling species [@Stuart2012], they are known to make use of more human-altered areas [@Whitaker2004; @Rao2013; @jones_how_2022], which can lead to frequent human-snake conflict [@Shankar2013a; @Marshall2018b].
Compared to the other species, the habitat selection of King Cobras is relatively more studied.
However, as of 2024 King Cobras have been split into four species [@shankar_king_2021; @das_taxonomic_2024], meaning that the information gathered on King Cobras in other areas may be less generalisable to the King Cobras in Thailand.
Additionally, the split means that the IUCN Redlist classification of Vulnerable may be optimistic due to the large original range of King Cobras.
The extremely low occurrence of King Cobra bites in Thailand means that instances of human-snake conflict are primarily a conservation concern as opposed to a human health concern [@Pochanugool1998; @Viravan1992].
Therefore, the split heightens the importance of being confident in these case studies conducted within the range of the now Northern King Cobra.

@Marshall2018 do not conclude on an actual selection, instead highlighting the King Cobras' excursions out of the protected forest.
@marshall_no_2020 look more specifically at selection, highlighting the importance of semi-natural areas that occupy the banks of irrigation canals and intersect the agricultural matrix surrounding the protected forest.
Therefore, we pooled both datasets and examine two non-mutually exclusive hypotheses.

King Cobra Hypothesis 1: King Cobras select for semi-natural habitat.

King Cobra Hypothesis 2~: King Cobras select for forest habitat.

### Burmese Python

@smith_native_2021 describe Burmese Python (*Python bivittatus*) habitat selection and movement.
Burmese Pythons are large (tracked individuals between  2.21 and 3.09m snout to vent length), ambush predators capable of tackling prey over 100% their own body mass [@bartoszek_natural_2018], and whose predation pressure can play a role in limiting mammal populations sizes [@dorcas_severe_2012].
The flexibility in prey size means snakes of this size are inevitably drawn into conflict with humans over livestock, a pattern mirrored across the globe for large snakes [@Miranda2016].

The conclusions of @smith_native_2021 on python habitat selection are similar to those made on King Cobras, with an active selection for areas near water.
The land classification used in @smith_native_2021 was slightly different to @marshall_no_2020, grouping semi-natural areas with larger water bodies (e.g., agricultural ponds).

Burmese Python Hypothesis 1~: Burmese Pythons select for areas near water.

### Malayan Krait

@hodges_malayan_2022 examine a smaller species, the Malayan Krait (*Bungarus candidus*). 
The Malayan Kraits tracked were between 0.65 and 1.46m snout to vent, and all lived on a university campus. 
Malayan Kraits, like many elapids, have a potent and medically significant venom; bites of Malayan Kraits can be fatal [@looareesuwan_factors_1988; @searo_regional_office_for_the_south_east_asia_rgo_guidelines_2016].
They are (mostly) nocturnal and actively foraging [@hodges_deadly_2021], known to depredate a wide range of prey [@hodges_diurnal_2020; @kuch_notes_2001].

Unlike the other case studies, @hodges_malayan_2022 is undertaken in a more urban environment.
The scale of the Malayan Krait movements meant the study was conducted at a finer spatial scale; habitat types are therefore more finely separated (e.g., buildings vs settlements).
The overall conclusions highlight two habitat types comprising of buildings and natural vegetation are potentially being selected for, in contrast to the lack of selection for open areas.

Malayan Krait Hypothesis 1~: Malayan Kraits select for buildings and natural areas.

### Banded Krait

@knierim_spatial_2019 looked at a larger krait species, the Banded Krait (*Bungarus fasciatus*).
Like its smaller cousin, the Banded Krait is also a nocturnal active forager, with a potent venom.
The Banded Krait is heavier-bodied and grows to longer lengths, tracked individuals ranging from 1.13 and 1.58 m snout to vent length.
However, unlike the Malayan Krait, the Banded Krait appears less tolerant of human disturbance in this region of Thailand and tends to have a more ophiophagus diet [@Knierim2017a].

Banded Kraits were entirely located in agricultural land, and like the other krait had movements more conducive to finer habitat classifications.
For example, field margins were found as a key nesting site [@knierim_spatial_2019].
@knierim_spatial_2019 shows the importance of field margins is reflected in the movement and habitat selection, as Banded Kraits follow the linear water or field margin features as opposed to the wider more exposed field areas.

Banded Krait Hypothesis 1~: Banded Kraits select for waterways and field edges.

## Tracking Data

We downloaded tracking data from Movebank or linked data repositories associated with the original studies.
The land use data were largely included with the associated data repositories; in cases where they were not we retrieved this from the original authors.
We collated all tracking and land use data, unifying the data formats, naming conventions, and converting files to more accessible formats.
We were left with two files for every study: a csv containing the movements of all individuals, and geoJSON file containing the polygon data describing land use.
The movement dataset contains seven columns: "species" = the scientific species name, "id" = the individual animal ID, "sex" = whether the individual is male (M) or female (F), "x" = the UTM Easting coordinate (m),"y" = the UTM Northing (m), "UTMzone" = the UTM zone either 47N or 48N, "datetime" = the date and time formatted as ISO 8601 "YYYY-MM-DD hh:mm:ss" recorded in "Asia/Bangkok".
The land use data contain geometry data in UTM projection and data on the "landuse" category as well as a "habitat" column denoting whether the habitat is part of a hypothesis.

To reacquaint ourselves with the data, and check for any potential issues that could hinder habitat selection analysis, we used code from @crane_lots_2021 to generate summaries of all the tracking datasets (archived code see reference for @crane_supplementary_2020).
During this process, we identified duplicated data points in the King Cobra data that required removal.
We suspect that these escaped detection during the initial publication [@Marshall2018] because the methods used did not use time in estimation of home range.

## Multiverse Construction

```{r readInOptions, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
library(stringr)
optionsComplete <- readRDS(here::here("data", "optionsCompleteList.rds"))
# might be worth pulling this from the summaries of the significance, that way we can ID rates of failure easier?
# prod(unlist(lapply(optionsComplete$pois, length)))
# prod(unlist(lapply(optionsComplete$ssf, length)))
# prod(unlist(lapply(optionsComplete$area, length)))
# prod(unlist(lapply(optionsComplete$areaMethods, length)))

```
To explore the variation that could arise when testing the above hypotheses, we constructed a multiverse of analytical choices.
A multiverse is a tree of branching paths, where decisions made during analysis spawn multiple branches, each with sudsequent analysis decisions.
Previous work has revealed the importance of data quantity over analysis decisions in determining habitat selection [@marshall_habitat_2024] (Chapter 3), but we are still left with sizeable variation in final answers –and perhaps more importantly, answers that offer contradictory conclusions.
The variation in results are similarly present in more practical demonstrations, such as many analysts projects [@gould_same_2023].

```{r decisionsFigure, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="A visual of all the decisions contained in the multiverse and colour coded to which approach that decision applies. Subtitle indicates the name of the decision, and the values or categroies below denote the choices explored in the multiverse. Each decision is combined with all others pertaining to the same analysis method, in unique combinations, and applied to each species to create the full count of habitat selection estimates."}
knitr::include_graphics(here::here("notebook", "ext_images", "decisions_visual.png"))
```

<!-- habitat class -->
Our multiverse starts with two alternative ways of defining the habitats.
Each case study has a map of available habitats, defined as categories.
One approach we used is to examine the habitat selection by retaining these categories, only simplifying them to fit the hypotheses.
This simplification took the habitat(s) of interest and codes them as 1, whereas all other habitats previously indicated in the studies to be avoided/not-selected for are coded as 0 (Fig. \@ref(fig:landscapePlotOPHA1); \@ref(fig:landscapePlotOPHA2); \@ref(fig:landscapePlotPYBI1); \@ref(fig:landscapePlotBUCA1); \@ref(fig:landscapePlotBUFA1)).
For example, in the case of Malayan Kraits, buildings and natural areas were classed as 1, and all other types classed as 0.
We then used the 0/1 classification as a predictor in the habitat selection analyses.
We undertook this simplification to facilitate the repeated use of generic code in the multiverse.
The second approach involved converting the simplified categorical habitat types into continuous rasters, where each cell described the distance to a given habitat type.
We inverted the distances (and scaled), so that a positive effect in the model meant a positive selection towards a habitat type, resulting in a more intuitive final output (Fig. \@ref(fig:landscapePlotOPHA1); \@ref(fig:landscapePlotOPHA2); \@ref(fig:landscapePlotPYBI1); \@ref(fig:landscapePlotBUCA1); \@ref(fig:landscapePlotBUFA1)).
All analyses (see below) were run on both classifications, with the exception of the Compositional Analysis that required categoric inputs.

The habitat selection methods we explored consisted of the following:

1. Resource Selection Functions (RSF) [@gillies_application_2006] and Composite Analysis (Compana) [@manly2007resource] that we called area-based methods, which used an estimated available area to help define availability for the snakes.

2. Step Selection Functions (SSF) [@thurfjell_applications_2014], Two-Step (Two-Step) [@craiu_conditional_2011], and Poisson models (Poisson) [@muff_accounting_2020] that we refer to as step-based methods, which used randomly generated alternative locations based on the movement and sinuosity of the individual being examined.

3. weighted Resource Selection Functions (wRSF) [@alston_mitigating_2023] a newly described method, which used a fitted movement model to calibrate the available habitat.

The area-based category made use of a defined area of availability, for which random available points can be drawn.
To explore the impact of the definition of available, we created a number of different polygons surrounding the tracking data locations.
We created available areas using Minimum Convex Polygons (MCP), Kernel Density Estimates (KDE: using the reference smoothing bandwidth [href]), and Autocorrelated Kernel Density Estimates (AKDE).
We used the adehabitatHR package for MCP and KDE creation [@adehabitatHR], and the ctmm package for AKDEs [@ctmm; @Calabrese2016; @Fleming2015; @Fleming2017].
For the AKDEs, we fitted a number of movement models: Ornstein-Uhlenbeck (OU), Ornstein–Uhlenbeck Foraging (OUF), and Independent Identically Distributed (IID); we selected the best performing by AICc.
We elected to follow guidance from [@silva_autocorrelationinformed_2022], opting for weighted AKDEs and the perturbative hybrid residual maximum likelihood method (pHREML).
The weighted AKDEs are better suited for tracking data with gaps.
All three methods require an outermost contour to be selected to define the edge of the available habitat; we varied this outer edge including analysis of 90, 95, and 99% contours.
For the AKDE areas, we selected the point estimate connected to the contour percentage, ignoring the 95% confidence intervals associated with the estimate.

Once an available area was defined, we generated points within the area to extract the available habitat (also referred to as available points).
We varied the point generation process, either spatially random or stratified across the overall area.
In addition to the point generation method, we varied the the number of available points by multiplying the number of known/used data points by `r paste0(range(optionsComplete$area$Method_ap), collapse = " to ")`.
As each individual had their own available area, we explored Type III habitat selection; this kept this analysis closer to the intent of the original publications.

Instead of using an available area, the step-based models use available steps randomly generated for each time step.
For these step-based methods a different suite of choices was explored.
First is the number of random steps generated per known location; we ranged this from `r paste0(range(optionsComplete$ssf$MethodSSF_as), collapse = " to ")`.
To generate those steps, we draw values from distributions, the choice of those distributions make up the next two choices.
For the random step lengths we looked at the impact of using Gamma and Exponential distributions; whereas for the turn angles, we looked at Von Mises and Uniform distributions.
Once the random available locations had been generated, we explore an additional choice regarding the model formula: whether to have the step lengths and turn angles interact with the habitat [@avgar_integrated_2016].
Termed "integrated step-selection", the inclusion of the step lengths and turn angles is meant to aid the acquisition of less biased estimates of habitat selection.
However, the impacts of the inclusion differ when using step-selection versus a Poisson model (see Chapter 3); we include it here to explore how dramatic that difference can be.
While the Poisson models explicitly target population level selection, the SSF models required summation to a single value.
To generate that value, we conducted a simple mean of the point estimates and calculated corresponding 95% confidence intervals.
This process likely underestimates the overall uncertainty surrounding the SSF methods, as the uncertainty surrounding the initial estimates is lost.

We also used the newly developed wRSF methods [@alston_mitigating_2023].
This approach dramatically reduces the choices during analysis; instead of requiring a defined area of availability, the wRSF weights individual animal locations (their impact penalised by repeated information resulting from autocorrelation) and compares them against a range distribution taking the form of a weighted AKDE [@alston_mitigating_2023].
Once the movement models had been generated, and wRSF models fitted, we used the supplied mean functionality within the ctmm package to generate overall population selection.

We handled the running of all analyses and their associated choices using the targets `r paste0("v.", packageVersion("targets"))` and tarchetypes `r paste0("v.", packageVersion("tarchetypes"))` R packages [@targets; @tarchetypes].
These packages allowed for efficient parallel processing and tracking of intermediate objects while avoiding errors in one analysis pathway from delays in the completion of others.

During the running of the multiverse, there were several instances of model fitting issues.
King Cobra 002, 004, and 005 had issues with step lengths fitting to an exponential distribution; we addressed this by excluding the top 25% quantile of observed steps when the exponential fit failed.
One Banded Krait individual did not have sufficient relocations to generate any area estimates; therefore we excluded them.
There were infrequent instances where individuals did not enter both habitat types (or available points did not cover both types made more likely with fewer available points); this caused issues with model fitting in Two-Step and SSF approaches.
We re-ran random step generation for those individuals to maximise the chances that available points captured both habitat types.
If the convergence failure persisted, we excluded those individuals from that habitat selection estimate end-point.

## Bayesian meta-analysis

We ran a series of `r length(list.files(here::here("modelOutput"), pattern = "^meta"))` Bayesian meta-analysis models to determine an overall estimate of habitat selection for each analysis approach and hypothesis, while accounting for as much as the multiverse structure as possible [@auspurg_toward_2024].
We used the following model formula: "estimate"|se("estimate confidence") ~ 1 + "choices" + (1|"index of analysis end point").
The estimate confidence measure varied from method to method: area-based Compana did not have a confidence interval, so we excluded that term; for the RSF and Two-Step estimates we used standard error; for the SSF models, we used standard errors of the model averaging; and for the Poisson models, we used the standard deviation.
Choices varied per method, and included a term for every choice made to reach a given analysis end point.
For the area-based methods (Compana, RSF), the choice terms included area method `r paste0(optionsComplete$area$areaMethod, collapse = ", ")`, contour percentage (`r paste0(optionsComplete$area$areaContour, collapse = ", ")`, scaled), available points generation method (`r paste0(ifelse(optionsComplete$area$Method_sp == "rd", "random", "stratified"), collapse = ", ")`), and the number of available points generated per animal location (`r paste0(range(optionsComplete$area$Method_ap), collapse = " to ")`, scaled).
The Compana analysis had the additional choice of test method (`r paste0(optionsComplete$areaMethods$areaBasedTest, collapse = ", ")`).
For the step-based methods (Two-Step, SSF, Poisson), the choice terms included model formula (integrated, non-integrated), step length distribution (Gamma, Exponential), turn angle distribution (Von Mises, Uniform), and the number of random steps generated per animal location (`r paste0(range(optionsComplete$ssf$MethodSSF_as), collapse = " to ")`, scaled).
The inclusions of "index of analysis end point" allows us to estimate *$\tau$^2^*, a measure of between-study heterogeneity.
We used weakly informative priors.
For the intercept prior, we used a normal distribution with a mean of 0 and a standard deviation of 2, and for the choices' priors we used Cauchy distributions with a location of -0.1 and scale as 3, except for the number of available points generated per animal location where we used a location of 0.1.
We ran Bayesian models using the brms package [@brms], running 4 MCMC chains for 1200 iterations each with a warmup of 400 and a thinning rate of 2.
For reporting, we used 95% median highest density continuous intervals when describing posteriors.
We used *R^2^* and *$\tau$^2^* to explore how much variation is explained by the analysis decisions, and the between-study heterogeneity (in this case analysis end points).

# Results

```{r summaryReadIn, echo=FALSE, message=FALSE}
# timeStepSummaries <- read.csv(file = here::here("tables", "summary_species_timeStep.csv"))
dataDuraMovesSummaries <- read.csv(file = here::here("tables", "summary_species_dataDuraMoves.csv"))
summaryTable <- read.csv(file = here::here("tables", "summary_individuals.csv"))

areaBasedResults <- readr::read_csv(file = here::here("data", "areaBasedEstimateOutputs.csv.gz"))
poisResults <- readr::read_csv(file = here::here("data", "poisEstimateOutputs.csv.gz"))
rsfResults <- readr::read_csv(file = here::here("data", "rsfEstimateOutputs.csv.gz"))
ssfResults <- readr::read_csv(file = here::here("data", "ssfEstimateOutputs.csv.gz"))
twoStepResults <- readr::read_csv(file = here::here("data", "twoStepEstimateOutputs.csv.gz"))
wrsfResults <- readr::read_csv(file = here::here("data", "wrsfEstimateOutputs.csv.gz"))

areaBasedCount <- nrow(areaBasedResults)
poisCount <- nrow(poisResults)
rsfCount <- nrow(rsfResults)
ssfCount <- nrow(ssfResults)
twoStepCount <- nrow(twoStepResults)
wrsfCount <- nrow(wrsfResults)

totalAnalyses <- sum(c(areaBasedCount, poisCount, rsfCount, ssfCount, twoStepCount, wrsfCount))

```

## Tracking Summary

Sample sizes and data density varied between species and individuals.
We tracked 25 King Cobras, 7 Burmese Pythons, 13 Malayan Kraits, and 3 Banded Kraits, which had adequate data for analysis (Fig. \@ref(fig:timeLinePlot)).
Tracking duration ranged widely from `r paste(round(range(summaryTable$duration), digits = 0), collapse = " to ")` days (Table. \@ref(tab:trackingSummaryTable)), being cut short by snake deaths, transmitter failure, and studies ending.
On average, we tracked an individual snake for `r round(mean(summaryTable$duration), digits = 2)` ±SD `r round(sd(summaryTable$duration), digits = 2)` days.
Despite best efforts to maintain a consistent tracking regime, snakes evade rediscovery, weather prevents tracking, and equipment fails.
Therefore, all species tend to have mean tracking lag times (i.e., the time between subsequent relocations) a little longer than intended (Fig. \@ref(fig:timeLagPlot); Table. \@ref(tab:trackingSummaryTable)).
Overall tracking effort resulted in `r format(sum(summaryTable$datapoints), big.mark = ",")` data points, across `r nrow(summaryTable)` snakes, resulting in a mean of `r round(mean(summaryTable$datapoints), digits = 2)` ±SD `r round(sd(summaryTable$datapoints), digits = 2)` per snake.

Activity and propensity to move varied between the species.
We recorded the most moves for King Cobras (`r round(dataDuraMovesSummaries[dataDuraMovesSummaries$species == "Ophiophagus hannah",]$movesMean, digits = 2)` ±SE `r round(dataDuraMovesSummaries[dataDuraMovesSummaries$species == "Ophiophagus hannah",]$movesSE, digits = 2)`), due to their more intensive tracking regime.
The other species had on average fewer recorded moves per individual, with Burmese Pythons making on average `r round(dataDuraMovesSummaries[dataDuraMovesSummaries$species == "Python bivittatus",]$movesMean, digits = 2)` ±SE `r round(dataDuraMovesSummaries[dataDuraMovesSummaries$species == "Python bivittatus",]$movesSE, digits = 2)` moves, followed by Banded Kraits with `r round(dataDuraMovesSummaries[dataDuraMovesSummaries$species == "Bungarus fasciatus",]$movesMean, digits = 2)` ±SE `r round(dataDuraMovesSummaries[dataDuraMovesSummaries$species == "Bungarus fasciatus",]$movesSE, digits = 2)`, and finally the more stationary Malayan Kraits with `r round(dataDuraMovesSummaries[dataDuraMovesSummaries$species == "Bungarus candidus",]$movesMean, digits = 2)` ±SE `r round(dataDuraMovesSummaries[dataDuraMovesSummaries$species == "Bungarus candidus",]$movesSE, digits = 2)`.

## Summarising Hypothesis Support

<!-- can we get the median estimates here for in text reference -->
The area-based Compositional analysis appeared to provide majority support for three out of five of our hypotheses: King Cobra H1, Malayan Krait H1, and Banded Krait H1 (Fig. \@ref(fig:specCurveArea)).
In contrast, King Cobra H2 and Burmese Python H1 hypotheses appeared almost entirely unsupported, with zero or one analysis end point resulting in significant support (Fig. \@ref(fig:specCurveAreaOPHA); \@ref(fig:specCurveAreaPYBI)).
The lack of support does not appear to be connected to any single analysis decision.
King Cobra H2 and Burmese Python H1 hypotheses appear more likely to be supported when using MCPs to define available area, and least likely when defined via AKDEs, but even using MCPs there is not consistent support in the point estimates.
High outlying support in Burmese Python H1 estimates are somewhat mitigated when larger numbers of available points are used.
Also, the other species revealed that available area method and contour can have varying impacts.
Only the Compana test method (randomisation or parametric) appears to have a consistent effect, with both Krait hypotheses seeing dramatically higher estimates of selection when parametric testing is used.
For Malayan Kraits, this does not change any conclusions (all estimates are significantly supportive; Fig. \@ref(fig:specCurveAreaBUCA)); however, for Banded Kraits this single decision is responsible for the half of estimates providing support (Fig. \@ref(fig:specCurveAreaBUFA)).

```{r specCurveArea, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Compositional (Compana) analysis. Top curves show all estimates, split by species and hypothesis, with coloured points indicating those with point estimates supporting the hypothesis (i.e., > 0). Labelled vertical lines show the median estimate for each species-hypothesis combination. Lower plots show the estimates relative to each analysis choice. Colour depict the species, and shape separate hypothesis 1 and 2 for the King Cobras (circles = hypothesis 1, triangle = hypothesis 2). Median estimates are shown with hollow diamonds, and species-hypothesis medians are connected with appropriately coloured lines."}
knitr::include_graphics(here::here("figures", "specCurve_area.png"))
```

Unlike the Compositional analysis, Resource Selection Functions estimate medians provided support for all hypotheses (Fig. \@ref(fig:specCurveRsf)).
Although, King Cobra H2's support is marginal.
The more limited support for King Cobra H2 (for both habitat classification methods) appears driven by those estimates based on MCP available areas and using wider contours (Fig. \@ref(fig:specCurveRsfOPHA)).
All other hypotheses are universally supported, and significantly so (with the exception of only six of 144 Burmese Python estimates).
The chosen available area method does appear to impact the variability of results, even among the positive selection estimates.
Those based on MCPs appear to be less variable regardless of other analysis decisions, but this pattern only exists when a continuous habitat classification was used.
The continuous habitat classification does appear to open the possibility for more dramatic variation in estimated selection strength.
The number of available points does seem to impact the estimates in both Krait species, but only when not using MCPs, and this impact appears to diminish above 29.

```{r specCurveRsf, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Resource Selection Function (RSF) analysis. Top curves show all estimates, split by species and hypothesis, with coloured points indicating those with point estimates supporting the hypothesis (i.e., > 0). Labelled vertical lines show the median estimate for each species-hypothesis combination. Lower plots show the estimates relative to each analysis choice. Colour depict the species, and shape separates hypothesis 1 and 2 for the King Cobras (circles = hypothesis 1, triangle = hypothesis 2). Median estimates are shown with hollow diamonds, and species-hypothesis medians are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_rsf.png"))
```

The Two-Step approach was by far the least effective and most problematic when running within a multiverse, as the models had frequent convergence issues.
This failure rate is particularly visible in the King Cobra data when run with low numbers of available points or with attempts to integrate step and turn angle into the equation (Fig. \@ref(fig:specCurveTwoStep)).
In addition to the failure rate, we see a more even spread of estimates that contrasts with the ideal "S" shape that would indicate more agreement between the analysis end points.
The lack of agreement in selection strength appears more prevalent when using the continuous habitat classification, but unlike with RSFs, increased variably does not appear connected to any single choice.
The most consistent impact of the choice is whether to integrate step and turn angle into the model formula.
As mentioned, this led to convergence issues for King Cobras, but for other species, the integrated formulations tended to result in more conservative estimates of selection.
Only for Malayan Kraits with a binary classification did the median estimate swap direction due to this analysis choice, and this explains the lower rates of significant selection (32/64; Fig. \@ref(fig:specCurveTwoStepBUCA)).

```{r specCurveTwoStep, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Two-Step analysis. Top curves show all estimates, split by species and hypothesis, with coloured points indicating those with point estimates supporting the hypothesis (i.e., > 0). Labelled vertical lines show the median estimate for each species-hypothesis combination. Lower plots show the estimates relative to each analysis choice. Colour depict the species, and shape separates hypothesis 1 and 2 for the King Cobras (circles = hypothesis 1, triangle = hypothesis 2). Median estimates are shown with hollow diamonds, and species-hypothesis medians are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_twoStep.png"))
```

The Step Selection Function approach was impacted by the habitat classification method (Fig. \@ref(fig:specCurveSsf)). 
When using a binary habitat classification, only the Kraits results showed broad support for the hypotheses.
Whereas when using the the continuous habitat classification, we see more universal support across species. 
This lack of support when using the binary classification was not clearly connected to any particular analysis decision.
The only decision that makes a consistent change when paired with binary classification was the number of available steps.
Increased steps tended to lower the overall variability of selection estimates, especially for Malayan Kraits.
While we did see near universal support for hypotheses in the continuous classification, the estimates for Burmese Pythons were more marginal with only 22 of 64 considered significantly supported (Fig. \@ref(fig:specCurveSsfPYBI)).
We should be cautious with this support, as the SSF model averaging method may be additionally reducing the uncertainty present in individual SSF models.
The impact of decisions are most visible in Malayan Kraits, whose estimates' strength is impacted by the step and turn angle distributions, as well as whether the formula was integrated.
The distribution choices make less of an impact, with the spread of estimates largely overlapping, but using an integrated model formula led to more generous and variable estimates of preference.
However, despite this impact, all bar one of Malayan Kraits' estimates significantly support the hypothesis regardless of habitat classification method (Fig. \@ref(fig:specCurveSsfBUCA)).

```{r specCurveSsf, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Step Selection Function (SSF) analysis. Top curves show all estimates, split by species and hypothesis, with coloured points indicating those with point estimates supporting the hypothesis (i.e., > 0). Labelled vertical lines show the median estimate for each species-hypothesis combination. Lower plots show the estimates relative to each analysis choice. Colour depict the species, and shape separates hypothesis 1 and 2 for the King Cobras (circles = hypothesis 1, triangle = hypothesis 2). Median estimates are shown with hollow diamonds, and species-hypothesis medians are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_ssf.png"))
```

The Poisson model approach appears similar to the SSF results, with universal support for the hypotheses when examining the median estimates (Fig. \@ref(fig:specCurvePois)).
Once again the most marginal support was seen in King Cobra H2, where both classification methods resulted in low median estimates of preference.
The marginal medians seem to be largely due to a single decision: whether or not to run an integrated model formulation.
In this case, the integrated models provide far more conservative estimates of selection, and for King Cobra H2 when using binary classification the median falls below zero (Fig. \@ref(fig:specCurvePoisOPHA)).
The impact of model formulation appears for all species, but the most dramatic impacts are seen when paired with binary habitat classification.
What is missed from the point estimates, and median summaries, is the large uncertainty surrounding estimates when using the binary classification.
Zero estimates when using the binary habitat provided significant support.
This contrasts with the continuous habitat classification, where all species-hypothesis combinations show complete or majority significant support.
The impacts of other decisions are considerably smaller than model formulation.
There appear to be advantages to generating more available points, as estimates with few points tend to explain the upper and lower outliers.
The mitigation of extreme estimates is best seen in Banded Kraits when using a continuous habitat classification (Fig. \@ref(fig:specCurvePoisBUFA)).

```{r specCurvePois, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Poisson model (Poisson) analysis. Top curves show all estimates, split by species and hypothesis, with coloured points indicating those with point estimates supporting the hypothesis (i.e., > 0). Labelled vertical lines show the median estimate for each species-hypothesis combination. Lower plots show the estimates relative to each analysis choice. Colour depict the species, and shape separate hypothesis 1 and 2 for the King Cobras (circles = hypothesis 1, triangle = hypothesis 2). Median estimates are shown with hollow diamonds, and species-hypothesis medians are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_pois.png"))
```

Our final analysis approach was using weighted Resource Selection Functions (wRSF).
All wRSF results provided support for the hypotheses (Fig. \@ref(fig:specCurveWrsf)).
Although, once again, support for King Cobra H2 when using a continuous classification is borderline and ultimately rounded to zero.
The King Cobra H1 saw no support when using the continuous habitat classification but clear support when the landscape was binary classified.
All other species saw unambiguous support when the habitat was binary classed, but when classed continuously as inverted distance, the 95% confidence intervals for Burmese Pythons and Banded Kraits approximated zero.

```{r specCurveWrsf, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the weighted Resource Selection Function (wRSF) analysis. Circles and numbers above show the point estimate, and the horizontal bars depict the 95% confidence interval. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_wrsf.png"))
```

## Meta-analysis Estimates

```{r metaAnalysisRead, echo=FALSE}

r2results <- read.csv(here::here("modelOutput", "brmsR2Results.csv"))

r2results <- r2results %>% 
    mutate(method = str_extract(model, "ssf|rsf|pois|twoStep|areaBased"),
           species = str_extract(model, "OPHA|PYBI|BUCA|BUFA"),
           hypothesis = str_extract(model, "H1|H2"),
           classLandscape = str_extract(model, "binary|continuous")) %>% 
    mutate(species = case_when(
      species == "OPHA" ~ "Ophiophagus hannah",
      species == "PYBI" ~ "Python bivittatus",
      species == "BUCA" ~ "Bungarus candidus",
      species == "BUFA" ~ "Bungarus fasciatus"
    ))

r2conditional <- r2results %>% 
    group_by(method, classLandscape) %>% 
    filter(variable == "r2 conditional")

tau2conditional <- r2results %>% 
  group_by(method, classLandscape) %>% 
  filter(variable == "tau2_sd_index_intercept")

```

The Bayesian meta-analyses tended to perform very well, with the population effects producing high *R^2^* values (`r paste0(sum(r2conditional$value > 0.6), "/", nrow(r2conditional))` > 0.6, median: `r round(median(r2conditional$value), digits = 2)` ±SD `r round(sd(r2conditional$value), digits = 2)`).
The RSF models had the highest *R^2^* values, with the continuous classification estimates being almost entirely described by the predictors (Fig. \@ref(fig:metaR2Plot)).
The step-based approaches tended to have more variable *R^2^*, with step-selection models having the lowest values.

*$\tau$^2^* values (between analysis end point heterogeneity) ranged from very low (`r signif(min(tau2conditional$value), digits = 2)`) for the binary classed RSF models examining Banded Kraits, to `r signif(max(tau2conditional$value), digits = 2)` for the binary classed Poisson models examining the same species.
Mostly *$\tau$^2^* values fell below 0.1 `r paste0(sum(tau2conditional$value < 0.1), "/", nrow(tau2conditional))` (overall median of `r round(median(tau2conditional$value), digits = 2)` ±SD `r round(sd(tau2conditional$value), digits = 2)`), largely mirroring results gained from meta-analyses and ecological many analysts projects [@gould_same_2023].

The intercepts of the meta-analysis models reveal that most hypotheses are supported overall, with the only exceptions existing when the habitat was binary classified (Fig. \@ref(fig:metaInterPlot)).
King Cobra H2 and Burmese Python H1 using Compana, Malayan Krait H1 using Two-Step, King Cobra H2 and Burmese Python H1 using SSF.

```{r metaInterPlot, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="Posterior estimates of the intercept for all meta-analysis models, with 95% HDCIs, indicating whether the overall meta-analysed habitat selection estimate supports the original conclusions. Positive values indicate support. Colour denote species, and shape seperates hypotheses for King Cobras. Continous habitat classifcation was incompatible with the Compana method, and so is not shown."}
knitr::include_graphics(here::here("figures", "metaIntercept.png"))
```

Overall the patterns, of meta-analysis results mirror the specification curves, and the similarities reappear in the analysis choice impacts.
Model formulation appeared to have the most dramatic effect on the meta-analysis estimates, and that effect is seen in all three step-based approaches (Fig. \@ref(fig:metaBetasPlot)).
The effects themselves were not consistent, with different directions and strengths depending on approach and species.
Only Banded Kraits were impacted consistently the same way, with the non-integrated estimates tending to have a positive impact on the estimates (Fig. \@ref(fig:metaBetasPlot)). 
Another choice that appears to have considerable impact was the available area method.
Like the model formulation, the impact varied by species and landscape classification.
It reveals that impact of available area method is not necessarily very predictable, and likely interacts with the specific movement characteristics of the study species.
Available points, either steps or points within an area, tended to be positively related to estimate strength.
This was reasonably universal, but the larger effects were seen in the Krait species, potentially suggesting greater impacts when the habitat's are defined at a finer spatial scale.

# Discussion

<!-- Muff et al. And third, we reiterated that the logistic regression likelihood to estimate RSFs should always be weighted with a large weight W on the available points, in order to ensure convergence to the IPP likelihood which is guaranteed for urn:x-wiley:00218790:media:jane13087:jane13087-math-0055 (Fithian & Hastie, 2013). -->
<!-- SHOULD RERUN RSF WITH WEIGHTING ON AVAILABLE, worth it, we didnt see convergence issues I don't think ??? -->

Our re-testing of snake habitat selection studies using a multiverse of over `r totalAnalyses` analysis endpoints suggests that the original conclusions remain broadly supported.
More specifically, it appears that there is a reasonably low chance that the analysis choices made in the original publications led to strange or outlying results.
While the multiverse revealed broad support for the direction of the selection, the strength of the effect was more sensitive, and we did identify a few analysis choices capable of contradicting the originally published results.

Of the four species we examined, Burmese Pythons' preference for water bodies appears the most marginal, but the preference was clear in all bar six RSF analyses and the wRSF analysis.
All these analysis approaches have different assumptions, and treat the data in different ways.
Therefore, the apparent disagreement between RSF and other methods may tell us something about the preference that Burmese Pythons are demonstrating.
Burmese Pythons are ambush hunters; therefore, their movements may be less informative compared to their overall location in the landscape.
Particularly if they remain at the same location for extended periods, for example during nesting [@smith_risk_2024].
RSFs' de-emphasis of movement compared to step-based methods, may explain the differences in support.
The support from the more modern wRSF may also be ascribable to a broader selection for water bodies.

We only saw two decisions that could clearly alter conclusions, and even those did not appear universal.
Banded Kraits' selection for field margins was supported by the vast majority of analyses, but the weakest support was when using Compositional analysis.
While the point estimates still suggested selection, a decision to use randomisation rather than parametric tests for significance would render all analysis non-significant.
Previous simulated scenarios have also revealed the sensitivity of estimates to this choice (Chapter 3).
Other species did not see the same impact; randomisation did lead to reduced strength estimates for Malayan Kraits, but all remained significant.
We suspect the weaker support seen in Compositional Analysis may be the result of location error.
Compositional analysis could only be used with the binary habitat classification.
While every effort was made during tracking to ensure a correct GPS location was retrieved, error is unavoidable especially in denser forested areas or near buildings.
Even small errors may lead to mismatches between the true location (and habitat) of an animal and the land-use data we had access to.
This mismatch may be more pronounced when habitats are rarer or when animals tend to remain near its edges.
Banded Kraits' focus on very thin field margins may have made it particularly susceptible, and similarly Burmese Pythons' selection for the banks of water bodies.
The rarity of these habitats may have also played a role, as we see a clear narrowing of the confidence intervals surrounding the estimates as we increased the number of available points sampled.
We suspect that location error resulting in binary habitat mis-classification may explain the large confidence intervals of the Poisson models and the limited support in *Python bivitattus* SSF analyses, as this uncertainty and lack of support is not visible in the continuous habitat models.

A second decision that could alter estimate strength dramatically was whether we used an integrated model formulation (i.e., include step and turn angle in the model formula).
The work of @muff_accounting_2020 and @forester_accounting_2009, as well as chapter 3 showed that integrated formulas have contrasting impacts on estimates in step-selection approaches and poisson models.
The step-selection models tend to produce less biased estimates when using an integrated formula, whereas the poisson models produced the opposite.
With those findings in mind, we should weight the findings using the non-integrated poisson models more heavily.
The non-integrated Poisson models show clearer support for the hypotheses in all cases with either classification, bar King Cobra H1 and Burmese Python H1 whose estimates seem negligibly impacted when using the continuous classification.
Unexpectedly the choice of model formulation did not have as noticeable impact in the step-selection approach, where only Malayan Kraits' estimates were markedly impacted.
Despite this, the strength of the selection exhibited by *Bungarus candidus* meant that the more conservative estimates from the non-integrated models did not render the selection estimates non-significant.

<!-- step-based approaches seem perhaps least predictable regarding choices -->
<!-- tau2 huge for binary poisson, paried with lower r2 suggests models is harder to predict, something off about binary classfication -->
<!-- end point group effect allows the estimation of tau2 which tells you variation between end point heterogeneity -->
<!-- r2 should tell us amount of var from choices -->

Overall, we found that the final estimates could not be completely predicted by the analysis choices, despite there existing no sampling variation in the primary data.
In some cases, such as RSF binary, the analysis decisions explained the vast majority of variation and *$\tau$^2^* indicated that there was very little heterogeneity between end points.
Whereas others such as the Poisson binary meta-analysis models left most of the variation unexplained, and indicated much higher levels of between end point heterogeneity, which appear comparable to meta-analysis on multiple real studies that would also need to be contending with sampling variation.
The propensity for the step-based methods to show higher *$\tau$^2^* values could be due to random sampling of step and turn angles in the available points.
The variation in *$\tau$^2^* and *R^2^* values from the meta-analysis models indicate that analysis choices are interacting with the species data and hypothesis, suggesting variation in habitat selection estimates may be difficult to predict in other systems and limited the generalisably of patterns shown here.

<!-- from many analyssts: -->
<!-- "We quantified both absolute () and relative () heterogeneity resulting from analytical variation. Both measures suggest that substantial variability among effect sizes was attributable to the analytical decisions of analysts. -->
<!-- The total absolute level of variance beyond what would typically be expected due to sampling error, -->
<!-- (Table 3.2), among all usable blue tit effects was 0.08 and for Eucalyptus effects was 0.27. This is similar to or exceeding the median value (0.105) of found across 31 recent meta-analyses (calculated from the data in Yang et al. 2023). The similarity of our observed values to values from meta-analyses of different studies based on different data suggest the potential for a large portion of heterogeneity to arise from analytical decisions. For further discussion of interpretation of in our study, please consult discussion of post hoc analyses below." -->
<!-- tau seemed sensitive to removal of outlying estimates, or those classed as flawed analysis - see the table -->
<!-- suggest in realaibty it is greater due to sampling differences -->

Despite the clear species-driven variation in how analysis choices impact final estimates, we can examine the results on a species-hypothesis-basis to determine whether overall our multiverse supports or contradicts previously published conclusions.
While the average or summation of multiverse findings cannot be used as to estimate a true effect, they do highlight the high likelihood of repeated analyses agreeing.
Their agreement with the other results (in terms of direction), and the fact they largely provide significant support for the original hypothesis is reason to be confident in the original conclusions.

## Conlcusions

### King Cobra

For King Cobras we examined two hypotheses.
The previously published conclusions that they make heavy use of semi-natural areas (i.e., banks of irrigation canals, and scrub between fields; @marshall_no_2020) is nearly universally supported regardless of approach, especially when classified as inverted continuous distance.
Why King Cobras use these habitats is not immediately clear, but it could be driven by prey availability (e.g., other snake species @Barnes2017; @Strine2018a), the avoidance of threats, and density of shelter sites.
Other reptiles are known to make use of linear habitats [@doherty_animal_2019; @Kay2016], including other snakes at this study site (i.e., King Cobra's prey; @Jones_supposed_2020).
Both prey species and King Cobras could be using these linear connected semi-natural areas a means of avoiding the more exposed and dangerous fields and anthropogenic areas.
Human activity in fields, such as ploughing, will kill snakes [@Knierim2017a], and we have documented many fatalities of King Cobras as a direct result of human actions (e.g., persecution, road collision; @marshall_no_2020).
We can be confident that suggestions regarding the importance of edge or scrub habitats amongst a human-modified landscape are robust in the face of a multitude of analysis choices.

The second hypothesis regarding their selection for forest was not nearly as widely supported and only appears to be supported in certain analysis approaches.
The original paper highlighted the propensity for King Cobras to leave the forest and the heightened movement particularly during breeding season [@Marshall2018], potentially mate searching behaviour.
Mate searching has been indicated as a potential seasonal driver of heightened movements in other snake species [@Bauder2016a; @Duvall1997].
The King Cobra dataset used in the first paper [@Marshall2018] was skewed towards King Cobras found in/near protected forest, hence the focus on forest use.
The data used here pooled old and new data that presents a more complete picture of King Cobra selection, likely weakened that association with protected forest.
However, data collected after the original paper showed individuals using the forest for nesting; to maintain access to the forest these individuals travelled via semi-natural areas and were required to cross roads [@jones_how_2022; @marshall_no_2020].
The nest construction of King Cobras requires adequate vegetated material to maintain the requisite internal nest temperatures [@dolia_house-warming_2023].
This highlights the potential importance of forested areas during certain times of year, even if it is less likely to be identified by the broad (rather generalised) habitat selection multiverse-analysis here.
Other studies have revealed King Cobra potentially favour less disturbed areas for nesting, even if a clear preference of forests is not apparent [@koirala_distribution_2021]. 

### Burmese Python

The conclusions regarding Burmese Pythons' habitat selection appear susceptible to differing analysis approaches, but overall we can be fairly confident in the assertion that Burmese Pythons ideally remain closer to water bodies.
The patterns of selection in Burmese Pythons appear more clearly with broader landscape level approaches compared to those using steps.
It is likely that Burmese Pythons are prioritising being close to water bodies for food and shelter.
The use of water bodies and aquatic landscapes is well documented in Burmese Python's invasive range in Florida, USA [@mutascio_modeling_2018], and in Thailand evidence of Burmese Pythons capitalising on both shelter and prey provided by the water bodies is apparent.
As mentioned for the King Cobras, edge areas in agricultural land in this area of Thailand are considerably less trafficked and modified compared to the agricultural matrix of crops.
Less disturbance likely boosts shelter site options, as well as ambush sites and associated prey (e.g., aquatic birds).
Shelter sites along edge habitats, such as field margins and banks, appear to be suitable for nesting (also evidenced by Banded Krait nest site choice; @smith_risk_2024; @knierim_spatial_2019).
Nesting requires prolonged periods of non-disturbance, evidencing the potential stability of some of these edge habitat areas.
Whereas for food, rice paddies can house suitable sized water birds [@fujioka_bird_2010], and Burmese Pythons in this area have been documented depredating domestic waterfowl [@smith_native_2021], together supporting suggestions that the water bodies are a resource.

### Malayan Krait

The previously published conclusions that Malayan Kraits prefer buildings and natural areas appears to be the most clearly supported and one of the least susceptible to analysis choices.
Broadly the analysis would support their selection for buildings and natural areas on the university campus.
We suspect the support is not due to a particular movement pattern, but instead the strength of the selection, which is visible in the wRSF and meta-analysis intercepts.
Malayan Kraits are likely avoiding open areas, instead choosing to make use of the presumably safer micro-habitats available in buildings and natural areas.
@hodges_malayan_2022 suggests these environments may be better for thermoregulation, and other evidence reveals buildings are used for foraging [@hodges_diurnal_2020; @hodges_deadly_2021].
The selection for buildings presents a clear potential for human-snake conflict.
Malayan Krait are highly medically significant [@looareesuwan_factors_1988; @searo_regional_office_for_the_south_east_asia_rgo_guidelines_2016], and apparent overlap between their preference and human movements could heighten the chances of human-snake interactions resulting the harm of either human or snake.
Fortunately, Malayan Krait are mostly nocturnal, presenting the chance for human and snake to avoid conflict temporally.
The robustness of the selection analyses means we can safely support the suggestions in @hodges_malayan_2022 for the university to encourage light use when moving in the evening and night, wearing of closed footwear, and ensuring buildings are adequately sealed [@samuel_venomous_2020].
The selection for natural areas may further present an opportunity to draw snakes away from buildings, if more ideal shelter sites are available farther from concentrations of human activity.
Studies elsewhere in Thailand have suggested that other medically significant snakes will avoid buildings, preferring more vegetated areas [@barnes_snake_2024].

### Banded Krait

Banded Kraits' conclusions fall mostly in the middle; they are very well supported by the overall meta-analysis intercepts but did clearly reveal some scenarios where researcher choice could have obscured what appears to be a selection for field margins.
As mentioned for other species, field margins and other edge habitats appear key to snakes' lives in agricultural areas in northeastern Thailand [@Knierim2018], providing shelter and movement corridors.
Banded Kraits support this.
Their use of edge habitats is not limited to sheltering, as like Burmese Pythons, the edges offer suitable (possibly communal) nest sites [@knierim_spatial_2019].
When paired with other studies indicating the importance of field margins for mammals and amphibians [@brown_habitat_2001; @groffen_preference_2018], particularly rice paddy edges, it is clear that Banded Kraits likely find all the resources required in these edge habitats.
The concentration to the field margins may indicate a human-snake interaction hotspot, the identification of which could aid refinement of agent-based snakebite risk maps (e.g., @goldstein_integrating_2021).

### Overall conclusions

<!-- Future - while things look ok here for direction. move towards modern methods, or methods that are scale independent if you want to extrapolate strength, e.g. bring in more mechanisms, mirror point made in review paper -->
Looking forward, we feel confident in the broad conclusions drawn by the original studies and that the analyses choices of the original publications did not result in peculiar conclusions.
The support originating from more modern methods is additionally reassuring.
The wRSFs should be best placed to provide us with a broad estimate of habitat selection, while simultaneously tackling the issues arising from inconsistent tracking [@alston_mitigating_2023].
However, the use of exact selection strengths should be examined in more detail if they are to be adapted to future purposes such as human-snake conflict prediction (as supported by simulation habitat multiverses; @marshall_habitat_2024; Chapter 3).
In those cases, reassessment of the selection using newer methods more acutely tailored to prediction may be required, either by greater integration of mechanistic drivers of snake movement, or via methods that are scale independent enabling better beyond-sample extrapolation (e.g., @michelot_langevin_2019).

Summarised together, this study reveals the robustness of snake habitat selection studies to researcher analysis choice, while also reaffirming the conclusions regarding the important role habitat patches (edges, banks, canals, etc.) play for snakes in an otherwise human dominated unsuitable landscape.

# Acknowledgements

BMM was funded by the Natural Environment Research Council (NERC) via the IAPETUS2 Doctoral Training Partnership.

# Software availablity

All code used in the creation of this manuscript is available at [https://github.com/BenMMarshall/multiverseSnakes](https://github.com/BenMMarshall/multiverseSnakes); and archived at [https://doi.org/10.5281/zenodo.14034844](https://doi.org/10.5281/zenodo.14034844).

In addition to packages mentioned in the methods, a complete list of software used follows.

We used *R* `r paste0("v.", version$major, ".", version$minor)` [@base] via *RStudio* v.2023.6.2.561 [@rstudio]. <!-- version has to be manually added because rstudioapi doesn't work in targets -->
We used *here* `r paste0("v.", packageVersion("here"))` [@here], *readr* `r paste0("v.", packageVersion("readr"))` [@readr], *inborutils* `r paste0("v.", packageVersion("inborutils"))` [@inborutils], 
*targets* `r paste0("v.", packageVersion("targets"))` and *tarchetypes* `r paste0("v.", packageVersion("tarchetypes"))` [@targets; @tarchetypes], and *qs* `r paste0("v.", packageVersion("qs"))` [@qs] to manage directory addresses and saved objects.

We used *ggplot2* `r paste0("v.", packageVersion("ggplot2"))` for creating figures [@ggplot2], with the expansions: *patchwork* `r paste0("v.", packageVersion("patchwork"))` [@patchwork], *ggridges* `r paste0("v.", packageVersion("ggridges"))` [@ggridges], *ggtext* `r paste0("v.", packageVersion("ggtext"))` [@ggtext], *ggnewscale* `r paste0("v.", packageVersion("ggnewscale"))` [@ggnewscale], and *ggdist* `r paste0("v.", packageVersion("ggdist"))` [@ggdist].

We used *brms* `r paste0("v.", packageVersion("brms"))` [@brms] to run Bayesian models, with diagnostics generated used *bayesplot* `r paste0("v.", packageVersion("bayesplot"))` [@bayesplot], *tidybayes* `r paste0("v.", packageVersion("tidybayes"))` [@tidybayes], and *performance* `r paste0("v.", packageVersion("performance"))` [@performance].

We used the *dplyr* `r paste0("v.", packageVersion("dplyr"))` [@dplyr], *tidyr* `r paste0("v.", packageVersion("tidyr"))` [@tidyr], *tibble* `r paste0("v.", packageVersion("tibble"))` [@tibble], and *stringr* `r paste0("v.", packageVersion("stringr"))` [@stringr] packages for data manipulation.

We used *sp* `r paste0("v.", packageVersion("sp"))` [@sp], *sf* `r paste0("v.", packageVersion("sf"))` [@sf2018; @sf2023; @sfheaders], *raster* `r paste0("v.", packageVersion("raster"))` [@raster], *terra* `r paste0("v.", packageVersion("terra"))` [@terra], *tidyterra* `r paste0("v.", packageVersion("tidyterra"))` [@tidyterra], and *move* `r paste0("v.", packageVersion("move"))` [@move] for manipulation of spatial data and estimation of space use not otherwise mentioned in the methods.
We used *ctmm* `r paste0("v.", packageVersion("ctmm"))` [@ctmm], *amt* `r paste0("v.", packageVersion("amt"))` [@amt], *adehabitatHS* `r paste0("v.", packageVersion("adehabitatHS"))` [@adehabitatHS], *adehabitatHR* `r paste0("v.", packageVersion("adehabitatHR"))` [@adehabitatHR], *lme4* `r paste0("v.", packageVersion("lme4"))` [@lme4], *INLA* `r paste0("v.", packageVersion("INLA"))` [@INLA; @INLA2], and *TwoStepCLogit* `r paste0("v.", packageVersion("TwoStepCLogit"))` [@TwoStepCLogit] for the habitat analyses.

We used rmarkdown `r paste0("v.", packageVersion("rmarkdown"))` [@rmarkdown2023; @rmarkdown2018; @rmarkdown2020], bookdown `r paste0("v.", packageVersion("bookdown"))` [@bookdown2016; @R-bookdown], tinytex `r paste0("v.", packageVersion("tinytex"))` [@tinytex2019; @tinytex2023], and knitr `r paste0("v.", packageVersion("knitr"))` [@knitr2015; @knitr2014; @knitr2023] packages to generate type-set outputs.

We generated R package citations with the aid of *grateful* `r paste0("v.", packageVersion("grateful"))` [@grateful].

# Data availabilty

The majority of the data is already publicly available.
Movement data can be accessed via Movebank [@kays_movebank_2022], with the following study IDs: 1649411628, 556564170, 1093796277, 1204811528.
Movement data and land use data was also available via the following data repositories: @marshall_data_2020; @smith_dataset_2020; @hodges_malayan_2021.

For the ease of recreating the results presented here, we have uploaded all movement and land use data, alongside the code used to generate this manuscript.
If using this compiled data, we highly suggest also citing the original data paper and repository as listed above to ensure the data maintains a close connection to descriptions of its collection.
<!-- add zenodo archived snapshot of github -->

# Author Contributions

Conceptualization: BMM, ABD, MC, IS, CTS, SNS, MDJ, TKK, and CWH;
Data curation: BMM;
Formal analysis: BMM;
Investigation: BMM, MC, IS, CTS, SNS, MDJ, TKK, and CWH;
Methodology: BMM and ABD;
Software: BMM;
Supervision: ABD;
Visualization: BMM;
Writing - original draft: BMM;
Writing - review & editing: BMM, ABD, MC, IS, CTS, SNS, MDJ, TKK, and CWH;

# Supplementary Material

## Tracking Summary

```{r trackingSummaryTable, echo=FALSE, message=FALSE, warning=FALSE}

knitr::kable(
  summaryTable,
  caption = "Summary of tracking effort, tracking time lags (hours), and step lengths (metres) for each species.",
  format = "latex",
  align = "lcc",
  vline = "",
  toprule = "",
  # midrule = "",
  linesep = "",
  bottomrule = "",
  col.names = c("Species", "Individual ID", "Number of Datapoints", "Total Tracking Duration (days)",
                "Mean Time Lag ± Standard Error (hours)", "Number of Moves", 
                "Mean Step Length ± Standard Error (metres)"), escape = FALSE) %>%
  kableExtra::kable_styling(font_size = 8, latex_options = c("scale_down", "hold_position"))
```

```{r timeLagPlot, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.pos = "h", fig.cap="The distribution between subsequent data points for each species. Circles below the distributions show the media time lag. Reported alongside is the mean, standard error (±), and range of time lags. Large time lags are usually the result of prolonged missing periods or transmitter failures. N.b., the x axis is square-rooted to aid with visualisation."}
knitr::include_graphics(here::here("figures", "timeLagPlot.png"))
```

```{r timeLinePlot, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="The timeline of all tracked individuals, split by species. Each recorded data point is depcited by a |."}
knitr::include_graphics(here::here("figures", "timeLinePlot.png"))
```

## Species-by-hypothesis Habitat Classification

```{r landscapePlotOPHA1, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="The landscape covariates used in the King Cobra models for hypothesis 1, overlayed with the recorded locations of the animals. Left hand: the binary classification where hypothesised habitats are classed as 1, whereas all other areas are classed as 0. Right hand: the inverted continuous landscape classification where higher values indicated proximity to a given land use or habitat."}
knitr::include_graphics(here::here("figures", "landscape_plot_OPHA_H1.png"))
```

```{r landscapePlotOPHA2, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="The landscape covariates used in the King Cobra models for hypothesis 2, overlayed with the recorded locations of the animals. Left hand: the binary classification where hypothesised habitats are classed as 1, whereas all other areas are classed as 0. Right hand: the inverted continuous landscape classification where higher values indicated proximity to a given land use or habitat."}
knitr::include_graphics(here::here("figures", "landscape_plot_OPHA_H2.png"))
```

```{r landscapePlotPYBI1, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="The landscape covariates used in the Burmese Python models for hypothesis 1, overlayed with the recorded locations of the animals. Left hand: the binary classification where hypothesised habitats are classed as 1, whereas all other areas are classed as 0. Right hand: the inverted continuous landscape classification where higher values indicated proximity to a given land use or habitat."}
knitr::include_graphics(here::here("figures", "landscape_plot_PYBI_H1.png"))
```

```{r landscapePlotBUCA1, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="The landscape covariates used in the Malayan Krait models for hypothesis 1, overlayed with the recorded locations of the animals. Left hand: the binary classification where hypothesised habitats are classed as 1, whereas all other areas are classed as 0. Right hand: the inverted continuous landscape classification where higher values indicated proximity to a given land use or habitat."}
knitr::include_graphics(here::here("figures", "landscape_plot_BUCA_H1.png"))
```

```{r landscapePlotBUFA1, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="The landscape covariates used in the Banded Krait models for hypothesis 1, overlayed with the recorded locations of the animals. Left hand: the binary classification where hypothesised habitats are classed as 1, whereas all other areas are classed as 0. Right hand: the inverted continuous landscape classification where higher values indicated proximity to a given land use or habitat."}
knitr::include_graphics(here::here("figures", "landscape_plot_BUFA_H1.png"))
```

## Species-by-species Specification Curves

### King Cobra

```{r specCurveAreaOPHA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Compositional (Compana) analysis for King Cobras (Ophiophagus hannah). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. Shape separates hypothesis 1 and 2 (circles = hypothesis 1, triangle = hypothesis 2). Median estimates are shown with hollow diamonds, and hypothesis medians are connected with appropriated coloured lines. "}
knitr::include_graphics(here::here("figures", "specCurve_King Cobra_area.png"))
```

```{r specCurveRsfOPHA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Resource Selection Function (RSF) analysis for King Cobras (Ophiophagus hannah). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_King Cobra_rsf.png"))
```

```{r specCurveTwoStepOPHA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Two-Step analysis for King Cobras (Ophiophagus hannah). Top curves show all estimates, split by hypothesis, with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate for each hypothesis. Lower plots show the estimates relative to each analysis choice. Shape separates hypothesis 1 and 2 (circles = hypothesis 1, triangle = hypothesis 2). Median estimates are shown with hollow diamonds, and hypothesis medians are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_King Cobra_twoStep.png"))
```

```{r specCurveSsfOPHA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Step Selection Function (SSF) analysis for King Cobras (Ophiophagus hannah). Top curves show all estimates, split by hypothesis, with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate for each hypothesis. Lower plots show the estimates relative to each analysis choice. Shape separates hypothesis 1 and 2 (circles = hypothesis 1, triangle = hypothesis 2). Median estimates are shown with hollow diamonds, and hypothesis medians are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_King Cobra_ssf.png"))
```

```{r specCurvePoisOPHA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Poisson model (Poisson) analysis for King Cobras (Ophiophagus hannah). Top curves show all estimates, split by hypothesis, with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate for each hypothesis. Lower plots show the estimates relative to each analysis choice. Shape separates hypothesis 1 and 2 (circles = hypothesis 1, triangle = hypothesis 2). Median estimates are shown with hollow diamonds, and hypothesis medians are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_King Cobra_pois.png"))
```

### Burmese Pythons

```{r specCurveAreaPYBI, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Compositional (Compana) analysis for Burmese Pythons (Python bivittatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines."}
knitr::include_graphics(here::here("figures", "specCurve_Burmese Python_area.png"))
```

```{r specCurveRsfPYBI, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Resource Selection Function (RSF) analysis for Burmese Pythons (Python bivittatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Burmese Python_rsf.png"))
```

```{r specCurveTwoStepPYBI, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Two-Step analysis for Burmese Pythons (Python bivittatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Burmese Python_twoStep.png"))
```

```{r specCurveSsfPYBI, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Step Selection Function (SSF) analysis for Burmese Pythons (Python bivittatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Burmese Python_ssf.png"))
```

```{r specCurvePoisPYBI, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.pos = "h", fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Poisson model (Poisson) analysis for Burmese Pythons (Python bivittatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Burmese Python_pois.png"))
```

### Malayan Kraits

```{r specCurveAreaBUCA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Compositional (Compana) analysis for Malayan Kraits (Bungarus candidus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines."}
knitr::include_graphics(here::here("figures", "specCurve_Malayan Krait_area.png"))
```

```{r specCurveRsfBUCA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Resource Selection Function (RSF) analysis for Malayan Kraits (Bungarus candidus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Malayan Krait_rsf.png"))
```

```{r specCurveTwoStepBUCA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Two-Step analysis for Malayan Kraits (Bungarus candidus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Malayan Krait_twoStep.png"))
```

```{r specCurveSsfBUCA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Step Selection Function (SSF) analysis for Malayan Kraits (Bungarus candidus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Malayan Krait_ssf.png"))
```

```{r specCurvePoisBUCA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Poisson model (Poisson) analysis for Malayan Kraits (Bungarus candidus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Malayan Krait_pois.png"))
```

### Banded Kraits

```{r specCurveAreaBUFA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Compositional (Compana) analysis for Banded Kraits (Bungarus fasciatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines."}
knitr::include_graphics(here::here("figures", "specCurve_Banded Krait_area.png"))
```

```{r specCurveRsfBUFA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the areas-based Resource Selection Function (RSF) analysis for Banded Kraits (Bungarus fasciatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Banded Krait_rsf.png"))
```

```{r specCurveTwoStepBUFA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Two-Step analysis for Banded Kraits (Bungarus fasciatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Banded Krait_twoStep.png"))
```

```{r specCurveSsfBUFA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Step Selection Function (SSF) analysis for Banded Kraits (Bungarus fasciatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Banded Krait_ssf.png"))
```

```{r specCurvePoisBUFA, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="All estimates of habitat selection derived from the step-based Poisson model (Poisson) analysis for Banded Kraits (Bungarus fasciatus). Top curves show all estimates with coloured points and corresponding confidence intervals indicating whether those estimates significantly support the hypothesis. Bottom right labels provide a count of estimates that significantly support the hypothesis out of the total estimates. Labelled vertical lines show the median point estimate. Lower plots show the estimates relative to each analysis choice. Median estimates are shown with hollow diamonds, and are connected with appropriately coloured lines. The plot is split left and right for the analysis using a binary classification (left), and continuous inverted distance (right)."}
knitr::include_graphics(here::here("figures", "specCurve_Banded Krait_pois.png"))
```

## Additional Meta-analysis Plots

```{r metaR2Plot, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="Conditional R2 values for all meta-analysis models, with 95% HDCIs."}
knitr::include_graphics(here::here("figures", "r2Plot.png"))
```

```{r metaBetasPlot, echo=FALSE, out.width='100%', fig.height=5, fig.width=3, fig.align="centre", fig.cap="Posterior estimates of the population effects for all meta-analysis models, with 95% HDCIs."}
knitr::include_graphics(here::here("figures", "metaBeta.png"))
```

\clearpage

# References
